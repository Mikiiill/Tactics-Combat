<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bump Game ‚Äì üòä chases üê±</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            text-align: center;
            background: #f9f9f9;
            padding: 20px;
        }
        h1 { color: #222; margin-bottom: 0.8em; }
        
        .board-container {
            display: inline-block;
            margin: 0 auto 1.5em;
        }
        
        .grid {
            display: grid;
            grid-template-columns: 50px repeat(3, 110px);
            grid-template-rows: 50px repeat(3, 110px);
            gap: 6px;
            font-size: 1.1rem;
            font-weight: bold;
        }
        
        .corner { background: transparent; border: none; }
        .col-label { background: #e0e0e0; border: 1px solid #888; border-radius: 6px; display: flex; align-items: center; justify-content: center; }
        .row-label { background: #e0e0e0; border: 1px solid #888; border-radius: 6px; display: flex; align-items: center; justify-content: center; writing-mode: vertical-rl; }
        
        .cell {
            position: relative;
            width: 110px;
            height: 110px;
            background: #fff;
            border: 2px solid #555;
            border-radius: 12px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.18s ease;
            overflow: hidden;
        }
        
        .cell:hover {
            transform: scale(1.06);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .cell.valid-move {
            background: #e6ffe6 !important;
            border-color: #2e7d32;
        }
        
        .cell[data-emoji]::after {
            content: attr(data-emoji);
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
            line-height: 1;
            pointer-events: none;
            user-select: none;
            z-index: 2;
            font-family: "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", emoji;
        }
        
        #status {
            font-size: 1.6rem;
            font-weight: bold;
            margin: 1.2em 0;
            min-height: 2.2em;
        }
        
        button {
            padding: 0.8em 1.8em;
            font-size: 1.3rem;
            background: #1976d2;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }
        button:hover { background: #1565c0; }
    </style>
</head>
<body>

<h1>Bump Game ‚Äì 3 bumps to win!</h1>

<div class="board-container">
    <div class="grid">
        <!-- Top row: empty + A B C -->
        <div class="corner"></div>
        <div class="col-label">A</div>
        <div class="col-label">B</div>
        <div class="col-label">C</div>

        <!-- Row 1 -->
        <div class="row-label">1</div>
        <div class="cell" id="cell-0-0" data-row="0" data-col="0"></div>
        <div class="cell" id="cell-0-1" data-row="0" data-col="1"></div>
        <div class="cell" id="cell-0-2" data-row="0" data-col="2"></div>

        <!-- Row 2 -->
        <div class="row-label">2</div>
        <div class="cell" id="cell-1-0" data-row="1" data-col="0"></div>
        <div class="cell" id="cell-1-1" data-row="1" data-col="1"></div>
        <div class="cell" id="cell-1-2" data-row="1" data-col="2"></div>

        <!-- Row 3 -->
        <div class="row-label">3</div>
        <div class="cell" id="cell-2-0" data-row="2" data-col="0"></div>
        <div class="cell" id="cell-2-1" data-row="2" data-col="1"></div>
        <div class="cell" id="cell-2-2" data-row="2" data-col="2"></div>
    </div>
</div>

<div id="status">üòä Your turn ‚Äì Bumps: 0</div>
<button onclick="resetGame()">New Game</button>

<script>
const gridSize = 3;
let playerPos = {row: 0, col: 0};   // A1 ‚Üí row 0, col 0
let opponentPos = {row: 1, col: 1}; // B2
let bumps = 0;
let turn = 'player';

function setEmoji(row, col, emoji = '') {
    const cell = document.getElementById(`cell-\( {row}- \){col}`);
    if (cell) cell.dataset.emoji = emoji;
}

function clearAllEmojis() {
    for (let r = 0; r < gridSize; r++) {
        for (let c = 0; c < gridSize; c++) {
            setEmoji(r, c, '');
        }
    }
}

function updateBoard() {
    clearAllEmojis();
    setEmoji(playerPos.row, playerPos.col, 'üòä');
    setEmoji(opponentPos.row, opponentPos.col, 'üê±');

    // Highlight valid moves
    document.querySelectorAll('.cell').forEach(cell => {
        cell.classList.remove('valid-move');
    });

    if (turn === 'player') {
        for (let dr = -1; dr <= 1; dr++) {
            for (let dc = -1; dc <= 1; dc++) {
                if (dr === 0 && dc === 0) continue;
                const nr = playerPos.row + dr;
                const nc = playerPos.col + dc;
                if (nr >= 0 && nr < gridSize && nc >= 0 && nc < gridSize) {
                    const cell = document.getElementById(`cell-\( {nr}- \){nc}`);
                    if (cell) cell.classList.add('valid-move');
                }
            }
        }
    }

    document.getElementById('status').textContent = 
        `${turn === 'player' ? 'üòä Your' : 'üê± Opponent'} turn ‚Äì Bumps: ${bumps}`;
}

function isAdjacent(r1, c1, r2, c2) {
    const dr = Math.abs(r1 - r2);
    const dc = Math.abs(c1 - c2);
    return dr <= 1 && dc <= 1 && (dr + dc > 0);
}

function handleClick(row, col) {
    if (turn !== 'player') return;

    if (!isAdjacent(playerPos.row, playerPos.col, row, col)) {
        alert("You can only move to an adjacent square (including diagonals).");
        return;
    }

    if (row === opponentPos.row && col === opponentPos.col) {
        // Bump
        bumps++;
        if (bumps >= 3) {
            alert("üéâ You win! 3 bumps achieved.");
            resetGame();
            return;
        }
        turn = 'opponent';
        updateBoard();
        setTimeout(opponentTurn, 900);
    } else {
        // Normal move
        playerPos = {row, col};
        turn = 'opponent';
        updateBoard();
        setTimeout(opponentTurn, 900);
    }
}

function opponentTurn() {
    const possible = [];
    for (let dr = -1; dr <= 1; dr++) {
        for (let dc = -1; dc <= 1; dc++) {
            if (dr === 0 && dc === 0) continue;
            const nr = opponentPos.row + dr;
            const nc = opponentPos.col + dc;
            if (nr >= 0 && nr < gridSize && nc >= 0 && nc < gridSize) {
                // Check if empty (no player there)
                if (!(nr === playerPos.row && nc === playerPos.col)) {
                    possible.push({row: nr, col: nc});
                }
            }
        }
    }

    if (possible.length === 0) {
        turn = 'player';
        updateBoard();
        return;
    }

    // Pick move farthest from player (Manhattan)
    let best = [];
    let maxDist = -1;
    possible.forEach(p => {
        const d = Math.abs(p.row - playerPos.row) + Math.abs(p.col - playerPos.col);
        if (d > maxDist) {
            maxDist = d;
            best = [p];
        } else if (d === maxDist) {
            best.push(p);
        }
    });

    const chosen = best[Math.floor(Math.random() * best.length)];
    opponentPos = chosen;
    turn = 'player';
    updateBoard();
}

function resetGame() {
    playerPos = {row: 0, col: 0};
    opponentPos = {row: 1, col: 1};
    bumps = 0;
    turn = 'player';
    updateBoard();
}

// Attach clicks
document.querySelectorAll('.cell').forEach(cell => {
    const r = parseInt(cell.dataset.row);
    const c = parseInt(cell.dataset.col);
    cell.addEventListener('click', () => handleClick(r, c));
});

// Initial render
updateBoard();
</script>
</body>
</html>
